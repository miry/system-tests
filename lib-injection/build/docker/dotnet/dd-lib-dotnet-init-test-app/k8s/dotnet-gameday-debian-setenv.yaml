apiVersion: v1
kind: Pod
metadata:
  labels:
    app: dotnet-gameday-debian-setenv
    admission.datadoghq.com/enabled: "true"
    admission.datadoghq.com/config.mode: "socket"
    tags.datadoghq.com/service: dotnet-gameday-debian-setenv
  annotations:
    admission.datadoghq.com/dotnet-lib.version: "v2.24.0"
  name: dotnet-gameday-debian-setenv
spec:
  containers:
    - name: dotnet-gameday-debian-setenv
      image: docker.io/ddzachmontoya/minimal-web-app:debian
      env:
      - name: CORECLR_ENABLE_PROFILING
        value: "0" # Set to be disabled
      - name: CORECLR_PROFILER
        value: "{918728DD-259F-4A6A-AC2B-B85E1B658318}" # Set to the OTEL .NET automatic instrumentation GUID
      - name: CORECLR_PROFILER_PATH
        value: "/dummy/path" # Set to an invalid value
      readinessProbe:
        timeoutSeconds: 1
        successThreshold: 1
        failureThreshold: 1
        httpGet:
          host:
          scheme: HTTP
          path: /
          port: 80
        initialDelaySeconds: 5
        periodSeconds: 5
      ports:
        - containerPort: 80
          hostPort: 8000
          protocol: TCP
      imagePullPolicy: Always
  # Add toleration so it can deploy to arm64 node
  tolerations:
  - key: "kubernetes.io/arch"
    operator: "Equal"
    value: "arm64"
    effect: "NoSchedule"
