apiVersion: v1
kind: Pod
metadata:
  labels:
    app: minimal-web-app-alpine
    admission.datadoghq.com/enabled: "true"
    admission.datadoghq.com/config.mode: "socket"
    tags.datadoghq.com/env: zach.montoya
    tags.datadoghq.com/service: minimal-web-app-alpine
  annotations:
    admission.datadoghq.com/dotnet-lib.custom-image: "ghcr.io/datadog/dd-trace-dotnet/dd-lib-dotnet-init:6ea4dfb30de09c7bc8034ba989c55f08aa5bcbe8-musl" # TODO: Use the default repo when ready
  name: minimal-web-app-alpine
spec:
  containers:
    - name: minimal-web-app-alpine
      image: docker.io/ddzachmontoya/minimal-web-app:alpine
      env:
      - name: DD_PROFILING_ENABLED
        value: "1"
      - name: DD_PROFILING_MIN_CORES_THRESHOLD
        value: "0"
      readinessProbe:
        timeoutSeconds: 1
        successThreshold: 1
        failureThreshold: 1
        httpGet:
          host:
          scheme: HTTP
          path: /
          port: 80
        initialDelaySeconds: 5
        periodSeconds: 5
      ports:
        - containerPort: 80
          hostPort: 8000
          protocol: TCP
      imagePullPolicy: Always
  tolerations:
  - key: "kubernetes.io/arch"
    operator: "Equal"
    value: "arm64"
    effect: "NoSchedule"
